# Techniques of Machine Learning

機械学習モデルとそのモデルが使用するデータを構築、使用、維持するプロセスは、他の多くの開発ワークフローとは全く異なるものです。このレッスンでは、このプロセスを解明し、知っておくべき主なテクニックの概要を説明します。このレッスンでは

- 機械学習を支えるプロセスを高いレベルで理解する。
- モデル」、「予測」、「トレーニングデータ」などの基本的な概念を探る。

## [Pre-lecture quiz](https://jolly-sea-0a877260f.azurestaticapps.net/quiz/7/)
## Introduction

機械学習（ML）プロセスの作成は、いくつかのステップで構成されています。

1. **質問を決定する**。ほとんどのMLプロセスは、単純な条件プログラムやルールベースのエンジンでは答えられない質問をすることから始まります。このような質問は、多くの場合、データの収集に基づく予測に関連しています。
2. **データの収集と準備**。質問に答えるためには、データが必要です。データの質や量によって、最初の質問にどれだけ答えられるかが決まります。データの可視化は、このフェーズの重要な側面です。この段階では、モデルを構築するために、データをトレーニンググループとテストグループに分けることも含まれます。
3. **トレーニング方法を選択する**。質問の内容やデータの性質に応じて、データを最もよく反映し、データに対して正確な予測を行うためのモデルの学習方法を選択する必要があります。これは、MLプロセスの中で、特定の専門知識を必要とする部分であり、多くの場合、かなりの量の実験が必要となります。
4. **モデルを訓練する**。学習データを用いて、様々なアルゴリズムを用いて、データのパターンを認識するモデルを学習します。モデルは、より良いモデルを構築するために、データの特定の部分を他の部分よりも優遇するように調整可能な内部の重みを活用することができます。
5. **モデルを検証する**。収集したデータの中から、今まで見たことのないデータ（テストデータ）を使って、モデルの性能を確認します。
6. **パラメータチューニング**。モデルの性能に基づいて、モデルの学習に使用されるアルゴリズムの動作を制御する異なるパラメータ（変数）を使用して、プロセスをやり直すことができます。
7. **予測する**。 新しい入力を使用して、モデルの精度をテストします。

## What question to ask

コンピュータは、データの中に隠れたパターンを発見することに特に長けている。この機能は、条件ベースのルールエンジンを作成しても簡単には答えられないような疑問を持っている研究者にとって非常に有用である。例えば、保険数理の課題では、喫煙者と非喫煙者の死亡率に関するルールを、データサイエンティストが手作業で作成することができます。

しかし、他の多くの変数が方程式に含まれる場合、過去の健康履歴に基づいて将来の死亡率を予測するMLモデルの方が効率的であることがわかります。もっと明るい例では、緯度、経度、気候変動、海への近さ、ジェット気流のパターンなどのデータに基づいて、ある場所の4月の天気を予測することができます。

✅ 気象モデルに関するこの[slideck](https://www2.cisl.ucar.edu/sites/default/files/0900%20June%2024%20Haupt_0.pdf)は、気象解析にMLを使うための歴史的な視点を提供しています。

## Pre-building tasks

モデルの構築を開始する前に、いくつかのタスクを完了する必要があります。疑問を検証し、モデルの予測に基づいて仮説を立てるためには、いくつかの要素を特定して設定する必要があります。

### Data

この質問に確実に答えるためには、適切な種類のデータが大量に必要になります。この時点でやるべきことは2つあります。

- **データの収集**。データ分析の公平性についての前のレッスンを念頭に置いて、データを慎重に収集してください。データの出所や固有のバイアスに注意し、その出所を記録します。
- **データの準備**。データの準備にはいくつかのステップがあります。様々なソースからデータを入手した場合、データを照合し、正規化する必要があります。[クラスタリング](../../../5-Clustering/1-Visualize/README.md)で行っているように、文字列を数字に変換するなど、さまざまな方法でデータの質と量を向上させることができます。また、元のデータに基づいて新しいデータを生成することもできます（[分類](../../../4-Classification/1-Introduction/README.md)で行っているように）。[Web App](../../../3-Web-App/README.md)のレッスンの前に行うように、データをきれいにしたり編集したりすることができます。最後に、トレーニングの手法によっては、ランダム化やシャッフルも必要になるかもしれません。

✅ データを収集して処理した後、そのデータの形状が意図した質問に対応できるかどうかを確認してみてください。[クラスタリング](../../../5-Clustering/1-Visualize/README.md)のレッスンで発見したように、与えられたタスクではデータがうまく機能しないかもしれません!

### Selecting your feature variable

[特徴](https://www.datasciencecentral.com/profiles/blogs/an-introduction-to-variable-and-feature-selection)とは、データの測定可能な特性のことです。多くのデータセットでは、「日付」「サイズ」「色」などの列の見出しとして表現されています。12月には、どんな**色**のカボチャが一番安いだろうか？ サンフランシスコでは、どんな地域の不動産の**価格**が一番高いだろうか？

🎓 **特徴選択と特徴抽出** モデルを構築する際に、どの変数を選択すればよいか、どうやって知ることができるでしょうか？おそらく、最もパフォーマンスの高いモデルに適した変数を選択するために、特徴選択や特徴抽出のプロセスを経ることになるでしょう。しかし、これらは同じものではありません。"特徴抽出は、元の特徴の関数から新しい特徴を作成するのに対し、特徴選択は特徴のサブセットを返すものである。" ([出典](https://wikipedia.org/wiki/Feature_selection))
### Visualize your data

データサイエンティストのツールキットの重要な側面は、SeabornやMatPlotLibなどの優れたライブラリを使ってデータを可視化する力です。データを視覚的に表現することで、隠れた相関関係を発見して活用できるかもしれません。また、視覚化することで、偏りや不均衡なデータを発見できるかもしれません（[Classification](../../../4-Classification/2-Classifiers-1/README.md)で発見しました）。
### Split your dataset

トレーニングの前に、データセットを2つ以上の不均等なサイズのパーツに分割する必要があります。

- **トレーニング**。データセットのこの部分は、モデルを訓練するためにあなたのモデルに適合させます。このセットは元のデータセットの大部分を占める。
- **テスト**。テストデータセットは独立したデータ群で、元のデータから集められることが多く、構築したモデルの性能を確認するために使用します。
- **バリデーション**。 検証データセットとは、モデルのハイパーパラメータやアーキテクチャを調整してモデルを改善するために使用する、より小さな独立した例のグループです。データのサイズや質問の内容によっては、この3つ目のセットを構築する必要がない場合もあります（[時系列予測](../../../7-TimeSeries/1-Introduction/README.md)に記載されています）。

## Building a model

トレーニングデータを用いて、様々なアルゴリズムを用いてモデル（データの統計的表現）を構築し、 **トレーニング** を行うことが目的です。モデルをトレーニングすることで、モデルはデータに触れ、発見したパターンを想定し、それを検証し、受け入れたり拒否したりすることができます。

### Decide on a training method

質問の内容やデータの性質に応じて、モデルを学習する方法を選択します。このコースで使用している[Scikit-learnのドキュメント](https://scikit-learn.org/stable/user_guide.html)を見ながら、モデルを学習するための様々な方法を検討することができます。経験によっては、最適なモデルを構築するために、いくつかの異なる方法を試す必要があるかもしれません。また、データサイエンティストは、見たことのないデータを与えてモデルの性能を評価し、精度や偏りなどの品質低下の問題をチェックし、目下の課題に最も適した学習方法を選択するというプロセスを踏むことになるでしょう。
### Train a model

学習データを手に入れたら、モデルを作成するためにデータを「フィット」する準備が整います。多くのMLライブラリには「model.fit」というコードがあることに気づくでしょう。この時、データを値の配列（通常は「X」）と特徴変数（通常は「y」）として送ります。
### Evaluate the model

トレーニングプロセスが完了したら（大きなモデルをトレーニングするには、何度も反復（エポック）する必要があります）、テストデータを使ってモデルの性能を評価することができます。このデータは、モデルが以前に分析していない元のデータのサブセットです。モデルの品質に関する評価指標の表を印刷することができます。

🎓 **モデルフィッティング**について

機械学習の文脈において、モデルのフィッティングとは、モデルが馴染みのないデータを分析しようとする際の、モデルの基本的な機能の精度を指す。

🎓 **学習不足**と**過学習**は、モデルの品質を低下させる一般的な問題で、モデルが十分にフィットしていなかったり、フィットしすぎたりします。これにより、モデルはトレーニングデータに近すぎたり、遠すぎたりして予測を行います。オーバーフィットモデルは、データの詳細やノイズをよく学習しているため、トレーニングデータをうまく予測しすぎてしまいます。アンダーフィットモデルは、トレーニングデータやまだ「見たことのない」データを正確に分析することができないため、正確ではありません。


![overfitting model](../images/overfitting.png)
> Infographic by [Jen Looper](https://twitter.com/jenlooper)

## Parameter tuning

最初のトレーニングが完了したら、モデルの品質を観察し、「ハイパーパラメータ」を調整することでモデルの改善を検討します。このプロセスについては、[ドキュメント](https://docs.microsoft.com/en-us/azure/machine-learning/how-to-tune-hyperparameters?WT.mc_id=academic-15963-cxa)で詳しく説明しています。

## Prediction

これは、全く新しいデータを使ってモデルの精度を検証する瞬間です。本番環境でモデルを使用するためにWeb資産を構築するような「応用」MLの設定では、このプロセスは、変数を設定するためにユーザーの入力（例えば、ボタンを押す）を収集し、推論または評価のためにモデルに送信することを含むかもしれません。

これらのレッスンでは、「フルスタック」のMLエンジニアになるために、これらのステップを使って、準備、構築、テスト、評価、予測など、データサイエンティストのすべてのジェスチャーを行う方法を学びます。

---

## 🚀Challenge

MLプラクティショナーのステップを反映したフローチャートを描いてみましょう。今の自分は、このプロセスのどこにいると思いますか？どこに困難があると予想していますか？あなたにとって簡単そうなことは何ですか？

## [Post-lecture quiz](https://jolly-sea-0a877260f.azurestaticapps.net/quiz/8/)

## Review & Self Study

日常業務について話し合うデータサイエンティストへのインタビューをオンラインで検索します。 その一つは[ここ](https://www.youtube.com/watch?v=Z3IjgbbCEfs)にあります。

## Assignment

[Interview a data scientist](../assignment.ja.md)
